
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>

        <script src="beDEWNR.js"></script>
    </head>
    <body>

        <div class="park-selector">
            <select class="park-selector__select"></select>

            <a class="park-selector__buton" href="#">Submit</a>
        </div>

        <div class="bookeasy__region-gadget"></div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

        <script>

            var aAllLocations = ['Beachport Conservation Park','Bool Lagoon Game Reserve','Canunda National Park','Coorong National Park','Deep Creek Conservation Park','Dutchmans Stern Conservation Park','Flinders Chase National Park','Innes National Park','Little Dip Conservation Park', 'Mount Remarkable National Park','Tallaringa Conservation Park']
            var aLocations = null;

            $w(function() {
                var bookingDate = new Date();
                bookingDate.setDate(bookingDate.getDate() + 1);

                BE.gadget.region('.bookeasy__region-gadget',{
                    limitLocations: aLocations,
                    accomOnlyMode: false,
                    collapseRefineTools: false,
                    customMapIcons: {
                        'accom': {
                            icon: '//www.environment.sa.gov.au/files/templates/00000000-0000-0000-0000-000000000000/c16a6c2a-2cdc-4f08-96b9-f1c11eb6f349/npsa-marker-general.png',
                            pinpoint: [13,45],
                            size: [26,45]
                        }
                    },
                    defaultSort: 'name',
                    defaultRegionState: 'South Australia',
                    disabledTypes: ['tours', 'events','carhire','packages'],
                    enableRegionSearch: false,
                    forceAccomType: '',
                    ignoreSearchCookie: true,
                    itemDetailPageURL: './detail.html',
                    showAllAccom: true,
                    showList: false,
                    showLocationFilter: true,
                    vcID: 188,
                    defaultDate: bookingDate,
                    period: 1,
                    adults: 1
                });
            });


            // TODO: parks data will be imported via DLV in json format
            var parksData = {
                    "locations" :{
                        "0" : "All",
                        "1" : "Beachport Conservation Park",
                        "2" : "Bool Lagoon Game Reserve",
                        "3" : "Canunda National Park",
                        "4" : "Coorong National Park",
                        "5" : "Deep Creek Conservation Park",
                        "6" : "Dutchmans Stern Conservation Park",
                        "7" : "Flinders Chase National Park",
                        "8" : "Innes National Park",
                        "9" : "Little Dip Conservation Park",
                        "10" : "Mount Remarkable National Park",
                        "11" : "Tallaringa Conservation Park",
                        "12" : "Vulkathunha-Gammon ranges National Park"
                    }
                };


                // get the url hash (removes '#/')
                var urlHash = location.hash.replace(/^#\//, '');

                // populate park selector
                $.each(parksData.locations, function(key, value) {

                    // append the option and check if currently selected
                     $('.park-selector__select').append($('<option></option').attr('value', value).attr('selected', urlHash == value ? true : false).text(value));

                });


                // on change update buttons href
                $('.park-selector__select').on('change', function(event) {

                    // update href
                    $('.park-selector__buton').attr('href', $(this).val());
                });


                // reload page to show correct bookeasy gadget
                $('.park-selector__buton').on('click', function(event) {

                    aLocations = [$(this).attr('href')];

                    return false;
                });
        </script>


    </body>
</html>
