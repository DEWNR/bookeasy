{% extends 'layouts/master.html' %}





{% block content %}

    {% include "shared/location-selector.html" %}

    <div class="bookeasy__region-gadget"></div>

{% endblock %}





{% block global_javascript %}
    {{ super() }}
{% endblock %}


{% block local_javascript %}
    <script src="//gadgets.impartmedia.com/gadgets.jsz?key={{ bookeasy_key }}"></script>

    <script>

        // TODO: parks data will be imported via DLV in json format
        var parksData = {
            "locations" :{
                "0": "All",
                "1": "Beachport Conservation Park",
                "2": "Bool Lagoon Game Reserve",
                "3": "Canunda National Park",
                "4": "Coorong National Park",
                "5": "Deep Creek Conservation Park",
                "6": "Dutchmans Stern Conservation Park",
                "7": "Flinders Chase National Park",
                "8": "Innes National Park",
                "9": "Little Dip Conservation Park",
                "10": "Mount Remarkable National Park",
                "11": "Tallaringa Conservation Park",
                "12": "Vulkathunha-Gammon ranges National Park"
            }
        };

        var aAllLocations = $.map(parksData.locations, function(val, i) { return val; }); // sets default locations from json data
        var aFilteredLocations = []; // contains an array of locations to show in region gadget
        var urlHash = location.hash.replace(/^#\//, '').trim();

        $(window).bind('hashchange', function() {

            aFilteredLocations = getFilteredLocations();

        });


        function getFilteredLocations() {

            // check if the hash has been set
            var aReturn = [];

            if (urlHash && (urlHash !== 'All')) {
                // set aFilteredLocations
                aReturn = [urlHash];
            } else {
                aReturn = aAllLocations;
            }

            return aReturn;
        }

        function createLocationSelector () {
            $.each( aAllLocations, function(key, val) {
                console.log('here 2');
                $('.location-selector__select').append($('<option></option').attr('value', val).attr('selected', urlHash == val ? true : false).text(val));
            });
        }

        createLocationSelector();

    </script>


{% endblock %}
